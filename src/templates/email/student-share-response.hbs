<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Sharing Response - UniTrack</title>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f3f4f6;
        padding: 20px;
        color: #111827;
      }
      .email-wrapper {
        max-width: 600px;
        margin: 0 auto;
        background: #fff;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid #e5e7eb;
      }
      .header {
        text-align: center;
        padding: 30px 20px;
        color: #fff;
      }
      .header.approved { background: #059669; }
      .header.declined { background: #dc2626; }
      .header h1 {
        font-size: 1.8rem;
        margin-bottom: 8px;
      }
      .subtitle {
        font-size: 1rem;
        opacity: 0.9;
      }
      .status-badge {
        display: inline-block;
        margin-top: 15px;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.95rem;
      }
      .status-badge.approved {
        background: #d1fae5;
        color: #065f46;
      }
      .status-badge.declined {
        background: #fee2e2;
        color: #991b1b;
      }
      .content {
        padding: 30px 20px;
      }
      .greeting {
        font-size: 1.2rem;
        font-weight: 600;
        color: #374151;
        margin-bottom: 15px;
      }
      .message {
        font-size: 1rem;
        color: #4b5563;
        margin-bottom: 25px;
        line-height: 1.5;
      }
      .details {
        background: #f9fafb;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid #e5e7eb;
      }
      .details.approved { border-color: #10b981; }
      .details.declined { border-color: #ef4444; }
      .detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
        font-size: 0.95rem;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 8px;
      }
      .detail-row:last-child { border: none; }
      .detail-label { font-weight: 600; color: #374151; }
      .detail-value { color: #6b7280; text-align: right; }
      .response-message {
        border-radius: 10px;
        padding: 15px;
        margin: 20px 0;
        font-size: 0.95rem;
      }
      .response-message.approved {
        background: #ecfdf5;
        border-left: 4px solid #10b981;
        color: #065f46;
      }
      .response-message.declined {
        background: #fef2f2;
        border-left: 4px solid #ef4444;
        color: #991b1b;
      }
      .next-steps {
        background: #eff6ff;
        border-left: 4px solid #3b82f6;
        border-radius: 10px;
        padding: 15px;
        margin: 20px 0;
        font-size: 0.95rem;
        color: #1e3a8a;
      }
      .footer {
        text-align: center;
        padding: 20px;
        background: #f9fafb;
        font-size: 0.85rem;
        color: #6b7280;
      }
      .timestamp {
        margin-top: 10px;
        font-size: 0.75rem;
        color: #9ca3af;
      }

      /* Dark mode */
      @media (prefers-color-scheme: dark) {
        body {
          background: #111827;
          color: #f9fafb;
        }
        .email-wrapper {
          background: #1f2937;
          border: 1px solid #374151;
        }
        .greeting { color: #f3f4f6; }
        .message { color: #d1d5db; }
        .details {
          background: #111827;
          border-left: 4px solid #374151;
        }
        .detail-label { color: #e5e7eb; }
        .detail-value { color: #9ca3af; }
        .response-message.approved {
          background: #064e3b;
          color: #d1fae5;
          border-left-color: #10b981;
        }
        .response-message.declined {
          background: #7f1d1d;
          color: #fee2e2;
          border-left-color: #ef4444;
        }
        .next-steps {
          background: #1e3a8a;
          color: #bfdbfe;
          border-left-color: #3b82f6;
        }
        .footer {
          background: #111827;
          color: #9ca3af;
        }
        .timestamp { color: #6b7280; }
        .status-badge.approved {
          background: #064e3b;
          color: #34d399;
        }
        .status-badge.declined {
          background: #7f1d1d;
          color: #fca5a5;
        }
      }
    </style>
  </head>
  <body>
    <div class="email-wrapper">
      <div class="header {{#if approved}}approved{{else}}declined{{/if}}">
        <h1>🎓 UniTrack</h1>
        <div class="subtitle">Student Sharing Response</div>
        <div class="status-badge {{#if approved}}approved{{else}}declined{{/if}}">
          {{#if approved}}✅ APPROVED{{else}}❌ DECLINED{{/if}}
        </div>
      </div>

      <div class="content">
        <div class="greeting">Hello {{requesterName}}! 👋</div>
        
        <div class="message">
          {{#if approved}}
            Great news! <strong>{{responderName}}</strong> has approved your request. 
            The {{studentCount}} student{{#if_gt studentCount 1}}s{{/if_gt}} are now added to your course.
          {{else}}
            <strong>{{responderName}}</strong> has declined your request. 
            The students were not added to your course.
          {{/if}}
        </div>

        <div class="details {{#if approved}}approved{{else}}declined{{/if}}">
          <div class="detail-row">
            <div class="detail-label">👨‍🏫 Responding Teacher:</div>
            <div class="detail-value">{{responderName}}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">📚 Your Course:</div>
            <div class="detail-value">{{requesterCourse}}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">📖 Source Course:</div>
            <div class="detail-value">{{sourceCourse}}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">👥 Students Requested:</div>
            <div class="detail-value">{{studentCount}} student{{#if_gt studentCount 1}}s{{/if_gt}}</div>
          </div>
          <div class="detail-row">
            <div class="detail-label">📅 Response Date:</div>
            <div class="detail-value">{{timestamp}}</div>
          </div>
        </div>

        {{#if responseMessage}}
        <div class="response-message {{#if approved}}approved{{else}}declined{{/if}}">
          💬 "{{responseMessage}}" - <strong>{{responderName}}</strong>
        </div>
        {{/if}}

        <div class="next-steps">
          {{#if approved}}
            🎯 The students are now enrolled. You can view them in your course list and start taking attendance.
          {{else}}
            💡 You can contact {{responderName}} for alternatives, or manually add students to your course.
          {{/if}}
        </div>
      </div>

      <div class="footer">
        <p>This is an automated message from UniTrack Attendance System.</p>
        <p>Log into your account to view updates.</p>
        <div class="timestamp">Response processed: {{timestamp}}</div>
      </div>
    </div>
  </body>
</html>
